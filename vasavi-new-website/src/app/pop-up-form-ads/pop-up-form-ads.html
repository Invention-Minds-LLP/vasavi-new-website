<div class="popup-overlay" *ngIf="isOpen" (click)="closePopup()">
  <div class="popup-container" (click)="$event.stopPropagation()">
    <!-- Header -->
    <div class="popup-header">
      <h2 class="popup-title">Contact Us</h2>
      <button class="close-btn" (click)="closePopup()" aria-label="Close">
        âœ•
      </button>
    </div>

    <!-- Contact Form Section -->
    <div class="form-section" *ngIf="!showOtpSection">
      <form [formGroup]="contactForm" (ngSubmit)="submitContactForm()">
        <!-- Name Field -->
        <div class="form-group">
          <label for="name" class="form-label">Name</label>
          <input
            type="text"
            id="name"
            class="form-input"
            [class.input-error]="contactForm.get('name')?.invalid && contactForm.get('name')?.touched"
            formControlName="name"
            placeholder="Enter your full name"
          />
          <span class="error-text" *ngIf="contactForm.get('name')?.invalid && contactForm.get('name')?.touched">
            {{ nameError }}
          </span>
        </div>

        <!-- Phone Number Field -->
        <div class="form-group">
          <label for="phoneNumber" class="form-label">Phone Number</label>
          <input
            type="tel"
            id="phoneNumber"
            class="form-input"
            [class.input-error]="contactForm.get('phoneNumber')?.invalid && contactForm.get('phoneNumber')?.touched"
            formControlName="phoneNumber"
            placeholder="Enter 10-digit phone number"
          />
          <span class="error-text" *ngIf="contactForm.get('phoneNumber')?.invalid && contactForm.get('phoneNumber')?.touched">
            {{ phoneError }}
          </span>
        </div>

        <!-- Submit Button -->
        <button
          type="submit"
          class="submit-btn"
          [disabled]="contactForm.invalid"
        >
          Send OTP
        </button>
      </form>
    </div>

    <!-- OTP Section -->
    <div class="form-section" *ngIf="showOtpSection">
      <div class="otp-message">
        <p>OTP sent to <strong>{{ contactForm.get('phoneNumber')?.value }}</strong></p>
      </div>

      <form [formGroup]="otpForm" (ngSubmit)="submitOtp()">
        <!-- OTP Field -->
        <div class="form-group">
          <label for="otp" class="form-label">Enter OTP</label>
          <input
            type="text"
            id="otp"
            class="form-input otp-input"
            [class.input-error]="otpForm.get('otp')?.invalid && otpForm.get('otp')?.touched"
            formControlName="otp"
            placeholder="000000"
            maxlength="6"
          />
          <span class="error-text" *ngIf="otpForm.get('otp')?.invalid && otpForm.get('otp')?.touched">
            {{ otpError }}
          </span>
        </div>

        <!-- OTP Actions -->
        <div class="otp-actions">
          <button
            type="submit"
            class="submit-btn"
            [disabled]="otpForm.invalid"
          >
            Verify OTP
          </button>
          <button
            type="button"
            class="back-btn"
            (click)="backToContactForm()"
          >
            Back
          </button>
        </div>
      </form>
    </div>
  </div>
</div>